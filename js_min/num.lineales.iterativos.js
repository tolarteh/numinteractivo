num.require(["jquery"],function(e){function a(a){if(!e("#matrix-"+a).length)return!1;var t=e("#matrix-"+a).attr("data-cols"),o=e("#matrix-"+a).attr("data-rows");if(1==t)for(var i=[],r=0;r<o;r++)i.push(Number(e("#matr-"+a+"-"+r+"-0").val()));else for(var i=[],r=0;r<o;r++){for(var n=[],l=0;l<t;l++)n.push(Number(e("#matr-"+a+"-"+r+"-"+l).val()));i.push(n)}return i}function t(e,a,t,o){var i='<div class="matrix" id="matrix-'+e+'" data-cols="'+a+'" data-rows="'+t+'">',r="";if(4==t&&!o)var o=[[[20,-1,3,4],[6,23,4,3],[7,21,46,9],[-3,-9,12,38]],[30,-10,20,-14],[0,0,0,0]];for(var n=0;n<t;n++){for(var l=0;l<a;l++)o&&(r=0==e?o[e][n][l]:o[e][n]),i+='<input size="6" id="matr-'+e+"-"+n+"-"+l+'" name="matr['+e+"]["+n+"]["+l+']" value="'+r+'"/>';i+="<br/>"}return i+="</div><br>"}function o(){var e='<div class="inputs" id="inputs">';return e+='<br>Columnas/Filas: <input size="2" class="matr-config" id="matr-num" name="matr-num" value="4"/> <button id="save" title="Guardar A y b">💾</button><button id="load" title="Escribir A y b guardados">✏️</button>',e+='</div><div id="matr-container"></div><br>Método: <select id="alk-selmetodo"></select><input type="button" name="submit" value="Resolver" id="submit"><br><br><div id="alk-desc"></div><div id="results"><div id="solution"></div></div>'}function i(a){e("#matr-container").html("");var o=e("#matr-num").val(),i="<table><tr><td>A = </td><td>"+t(0,o,o,a)+"</td><td>b = </td><td>"+t(1,1,o,a)+"</td><td>$x_0$ = </td><td>"+t(2,1,o,a)+"</td></tr></table>";i+='Relajación: <select id="alk-relajacion"><option value="1" selected="selected">Sí</option><option value="0">No</option></select>',i+=' Lambda ($\\lambda$): <input id="alk-lambda" name="alk-lambda" title="Valor de Lambda" value="1.24" oninvalid="this.setCustomValidity(\'Solo se admite digitos y un punto.\')" oninput="setCustomValidity(\'\')" pattern="[+]?([0-1]+\\.?[0-9]*|2)" required="" type="text"></div>',i+='<br>Tolerancia: <input id="alk-tol" name="alk-tol" title="" value="0.00006" oninvalid="this.setCustomValidity(\'Solo se admite digitos y un punto,  números positivos.\')" oninput="setCustomValidity(\'\')" pattern="[+]?([0-9]+\\.?[0-9]*)" required="" type="text">',i+='<br>Iteraciones: <input id="alk-ni" name="alk-ni" title="" value="20" oninvalid="this.setCustomValidity(\'Solo se admite números enteros positivos.\')" oninput="setCustomValidity(\'\')" pattern="[+]?([1-9]+)" required="" type="text">',e("#matr-container").append(i),MathJax.Hub.Queue(["Typeset",MathJax.Hub])}function r(){return e("#num-lineales").attr("data-metodo")?e("#num-lineales").attr("data-metodo"):s[0].id}function n(a){if(void 0!==e("#num-lineales").attr("data-lista")&&"true"==e("#num-lineales").attr("data-lista"))for(var t=0;t<s.length;t++)s[t].id==a?e('<option value="'+s[t].file+'" selected="selected">'+s[t].name+"</option>").appendTo("#alk-selmetodo"):e('<option value="'+s[t].file+'">'+s[t].name+"</option>").appendTo("#alk-selmetodo");else e("#alk-tdselmetodo").html("")}function l(){for(var a,t=e("#alk-selmetodo").val(),o=0;o<s.length;o++)s[o].id==t&&(a=s[o]);return a||(console.error("Metodo solicitado no existe, se procede a cargar el primero de la lista."),a=s[0]),a}function d(){}e(document).on("change","#alk-relajacion",function(){e("#alk-lambda").prop("disabled",0==e("#alk-relajacion").val())});var s=[{name:"Jacobi",file:"jacobi",id:"jacobi",desc:"El método de eliminación Gaussiana simple parte de transforma la matriz original ($Ax = b$), por medio de un proceso de eliminación progresiva de variables que busca tener sólo una ecuación con una incógnita ($Ux = b$), de forma que terminado dicho proceso se proceda hacer sustitución regresiva para así poder hallar todos los valores de $x$; esto se logra a través de operaciones básicas llamadas operaciones de renglón, que son intercambio de filas, multiplicación de una fila por un escalar y  sustitución de una fila."},{name:"Gauss Seidel",file:"gaussSeidel",id:"gaussSeidel",desc:"El método de eliminación Gaussiana con pivoteo parcial permite evitar los errores de redondeo por números cercanos a cero, de forma que busca que el elemento de la diagonal principal sea el mayor posible, en caso de no serlo usa el intercambio de filas hasta hallar el mayor y así convertirlo en el elemento pivote, con el fin de que al realizar la división por dicho término no sea cero o próxima a este.Luego de obtener el elemento pivote se procede con el método de eliminación Gaussiana Simple para obtener los valores de todas las variables."}],u=function(e){try{var a=e.toString();return a.indexOf("e")>0&&(a=a.replace("e","x10<sup>")+"</sup>"),a}catch(a){return e}},c=function(a){e("#results").append('<table class="num" id="resultado"><thead id="resTitles"><tr></tr></thead><tbody></tbody></table>'),e("#resultado thead tr").append("<td>$n$</td>");for(var t=0;t<a[0][0].length;t++)e("#resultado thead tr").append("<td>$$x_"+(t+1)+"$$</td>");for(e("#resultado thead tr").append("<td>$Error$</td>"),t=0;t<a.length;t++){var o=e("<tr></tr>");o.append("<td>"+(t+1)+"</td>");for(var i=0;i<a[t][0].length;i++)o.append("<td>"+a[t][0][i]+"</td>");o.append("<td>"+u(a[t][1].toExponential(1))+"</td>"),e("#resultado tbody").append(o)}},m=function(e){console.log("Matriz es diagonal estricta dominante?");for(var a=(e.length,0),t=0;t<e.length;t++){for(var o=1;o<e.length;o++)t!=o&&(a+=Math.abs(e[t][o]));return Math.abs(e[t][t])>a}};e(document).on("change",".matr-config",function(){i()}),e(document).on("click","#save",function(){if(!confirm("¿Seguro deseas guardar el A y b actuales?\n\nSi ya has guardado otros datos, serán sobreescritos y no se podrán recuperar.\nRecuerda que los datos se guardan en el navegador que estas usando actualmente."))return!1;var e=[];e.push(a(0));for(var t=a(1),o=[],i=0;i<t.length;i++)o.push(t[i][0]);e.push(o);for(var r=a(2),n=[],i=0;i<r.length;i++)n.push(r[i][0]);e.push(n),localStorage.setItem("matriz37",JSON.stringify(e))}),e(document).on("click","#load",function(){if(!localStorage.matriz37)return alert("No tienes datos guardados para escribir. Primero guarda A y b."),!1;if(!confirm("¿Seguro deseas escribir el A y b que tenías guardado? El A y b actuales serán eliminados."))return!1;var a=JSON.parse(localStorage.getItem("matriz37"));e("#matr-num").val(a[0].length),i(a)}),"undefined"==typeof Storage||(e("#save").hide(),e("#load").hide()),e(document).on("change","#alk-selmetodo",function(){d()}),d(),e(document).on("click","#showSolution",function(){e("#solution").show()}),e(document).on("click","#submit",function(){var t=l(),o=a(0),i=a(1),r=a(2),n="0"!=e("#alk-relajacion").val(),d=e("#alk-lambda").val(),s=e("#alk-ni").val(),u=e("#alk-tol").val();return e("#results").html("<div id='solution'></div>"),e("#solution").hide(),m(o)?(e("#solution").append("<h2>"+t.name+"</h2>"),void num.require(["lineales/"+t.file],function(){try{var a=window[t.id](o,i,r,n,d,s,u);e("#results").append("<div>"+a.message+"</div>"),c(a.data)}catch(a){console.log(a),"Error: División por cero"==a&&(e("#results").append("<p style='color:red'><b>Se ha encontrado una división por cero.</b><br>Por favor, revise los valores de la matriz y que el tipo de método que está usando sea el adecuado.</p>"),e("#solution").show())}MathJax.Hub.Queue(["Typeset",MathJax.Hub])})):void e("#results").append("<p style='color:red'><b>La matriz insertada NO es diagonal estricta dominante</b><br>Por favor, inserte una matriz que lo sea para poder ejecutar el método.</p>")}),e("#num-lineales").append(o()),n(r()),i()});